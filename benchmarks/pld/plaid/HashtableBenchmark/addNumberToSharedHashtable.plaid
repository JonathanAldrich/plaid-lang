package plaid.HashtableBenchmark;

import plaid.examples.lib.hashtable.Hashtable;
import plaid.examples.lib.hashtable.makeNumber;
import java.io.BufferedReader;

@sequential 
method void addNumberToSharedHashtable(local shared Hashtable ht, unique BufferedReader br) {
    val nextLine =  br.readLine();
    match ( nextLine ) {
        case String {
            // convert to number and add to hashtable 
            val integer = java.lang.Integer.valueOf(nextLine);
            val num = makeNumber(integer);
            ht.addShared(num);
            
            // tail-recursive call ourself to process next number
            addNumberToSharedHashtable(ht, br);
        }
        default { /* nop */ }
    }
}