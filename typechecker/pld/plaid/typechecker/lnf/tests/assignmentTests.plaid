package plaid.typechecker.lnf.tests;

import plaid.ast.*;

val () -> void assignmentTests = fn() => {
	val unique Assignment bareAssignment = new Assignment {
		val immutable Token token = makeToken();
		val unique Expression target = createSome(makeID(makeToken(),"x"));
		val unique ID field = makeID(makeToken(),"f");
		val unique Expression value = makeID(makeToken(),"y");
	};

	rewrite(bareAssignment);
	
	val unique Assignment assign1 = new Assignment {
		val immutable Token token = makeToken();
		val unique Expression target = createSome(new Dereference {
			val immutable Token token = makeToken();
			val unique Expression left = makeID(makeToken(),"a");
			val unique ID right = makeID(makeToken(),"b");
		});
		val unique ID field = makeID(makeToken(),"f");
		val unique Expression value = makeID(makeToken(),"y");
	};
	
	rewrite(assign1);
	
	val unique Assignment assign2 = new Assignment {
		val immutable Token token = makeToken();
		val unique Expression target = createSome(makeID(makeToken(),"x"));
		val unique ID field = makeID(makeToken(),"f");
		val unique Expression value = new Dereference {
			val immutable Token token = makeToken();
			val unique Expression left = makeID(makeToken(),"a");
			val unique ID right = makeID(makeToken(),"b");
		};
	};
	
	rewrite(assign2);
	
	val unique Assignment assign3 = new Assignment {
		val immutable Token token = makeToken();
		val unique Expression target = createSome(new Dereference {
			val immutable Token token = makeToken();
			val unique Expression left = makeID(makeToken(),"x");
			val unique ID right = makeID(makeToken(),"y");
		});
		val unique ID field = makeID(makeToken(),"f");
		val unique Expression value = new Dereference {
			val immutable Token token = makeToken();
			val unique Expression left = makeID(makeToken(),"a");
			val unique ID right = makeID(makeToken(),"b");
		};
	};
	
	rewrite(assign3);
};